---
title: "Practical1"
---

Setup

```{r}
#| echo: false
attach(airquality)
airquality
```

Rows with missing values

```{r}
sort(union(which(is.na(airquality[,1])), which(is.na(airquality[,2]))))
```

Summary Statistics

```{r}
#| echo: false

#Tempurature summary statistics 
mean_Temp = mean(Temp)
min_Temp = min(Temp)
max_Temp = max(Temp)
sd_Temp = sd(Temp)

#Ozone Summary statistics
mean_Oz = mean(Ozone)
min_Oz = min(Ozone)
max_Oz = max(Ozone)
sd_Oz = sd(Ozone)
```

Simple Linear Regression

```{r}
#| echo: false
attach(cars)
```

First principles

```{r}
X <-  matrix(data = cbind(rep(1, 50) ,cars$speed), nrow = 50, ncol = 2)
Y <-  cars$dist

#Model coefficient estimates
betas = (solve(t(X)%*%X))%*%(t(X)%*%Y)
fitted <- X%*%betas #fitted values

#Standard errors
cov <- solve(t(X)%*%X) #covariance matrix
SSE <- sum((Y-fitted)**2) #error sum of squares
n <-  length(Y)
s <-  sqrt(SSE/(n-2)) #residual standard error
se1 <- s*sqrt(cov[1]) #standard errors
se2 <- s*sqrt(cov[4])

#t-values
t1 <- betas[1]/se1
t2 <- betas[2]/se2

#p-values
p1 <- 2*pt(q = t1, df = n-2, lower.tail = FALSE)
p2 <- 2*pt(q = t2, df = n-2, lower.tail = FALSE)
p2
mod1manual <- list(coefficients = round(betas,4), Std.Error = c(round(se1,4),round(se2,4)), tvalue = c(round(t1,4),round(t2,4)), p = c(round(p1,4),round(p2,4)))


```

The estimates found via first principles are -17.57905 for the intercept coefficient and 3.932409 for the slope coefficient.

Using lm package

```{r}
X2 <- cars$speed
mod <- lm(Y~X2)
summary(mod)
```

We will now test to see if the lm function agrees with our first principal results

```{r}

mod$coefficients
#Model coefficient differences
round(summary(mod)[["coefficients"]][, "Estimate"],4) == mod1manual$Estimate

round(summary(mod)[["coefficients"]][, "Std. Error"],4) == mod1manual$Std.Error

round(summary(mod)[["coefficients"]][, "t value"],4) == mod1manual$tvalue

round(summary(mod)[["coefficients"]][, "Pr(>|t|)"],4) == mod1manual$p


```

Since the differences between the appropriate estimates are negligible, we conclude that thge lm model agrees with the first principal calculations.
